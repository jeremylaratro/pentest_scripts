# Standalone version of VHOST fuzzer from full enumeration script.
# Takes a domain and a wordlist and automatically hides recurring value.
# SecLists/Discovery/DNS/subdomains-top1million-20000.txt
# Usage: ./subfuzz.sh domain /path/to/wordlist
timeout 5 wfuzz -c -w $2 -H "Host: FUZZ.$1" $1 > initial_fuzz.txt
hide=$(cat initial_fuzz.txt | grep -oP '\b[0-9]{1,4}(?= L\b)' | uniq) 
echo "Hiding: $hide"
echo "Performing VHOST fuzzing on $1"
wfuzz -w $2 --hl $hide -H "Host: FUZZ.$1" $1
