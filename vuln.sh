#!/bin/bash


ssh_() {
    rm srch.txt
	touch srch.txt
	cat vulnchk.xml | grep 'ssh' | grep -o 'product=".*"' | cut -d \" -f2 | grep -o '^\S*'  > srch.txt
    cat vulnchk.xml | grep 'ssh' | grep -oE 'version="[0-9]?.[0-9]?.' | grep -Eo '[0-9]?.[0.9]..' >> srch.txt
    vv=$(cat srch.txt)
    if [ ! -z srch.txt ]; then
      echo 'Searching exploitdb for' $vv
      searchsploit $vv
      echo 'Analyzing ssh vulnerabilities'
      nmap $ip --script=ssh-\* -v
      echo ' '
      
    else
      echo ' '
    fi
	
}
ssh_

ftp_() {
	rm srch.txt
	touch srch.txt
	cat vulnchk.xml | grep 'ftp' | grep -o 'product=".*"' | cut -d \" -f2 | grep -o '^\S*'  > srch.txt
	cat vulnchk.xml | grep 'ftp' | grep -oE 'version="[0-9]?.[0-9]?.' | grep -Eo '[0-9]?.[0.9]..' >> srch.txt
	vv=$(cat srch.txt)
	if [ ! -z srch.txt ]; then
		echo 'Searching exploitdb for' $vv
		searchsploit $vv
		echo ' '
		
	else
		echo ' '
	fi
}
ftp_

smb_() {
	rm srch.txt
	touch srch.txt
	cat vulnchk.xml | grep 'smb' | grep -o 'product=".*"' | cut -d \" -f2 | grep -o '^\S*'  > srch.txt
	cat vulnchk.xml | grep 'smb' | grep -oE 'version="[0-9]?.[0-9]?.' | grep -Eo '[0-9]?.[0.9].' >> srch.txt
	vv=$(cat srch.txt)
	if [ ! -z srch.txt ]; then
		echo 'Searching exploitdb for' $vv
		searchsploit $vv
		echo ' '
		echo 'Analyzing smb vulnerabilities'
        nmap $ip --script=smb-vuln\* -v
        echo ' '
		
	else
		echo ' '
	fi
}
smb_

web_() {
	rm srch.txt
	touch srch.txt
	cat vulnchk.xml | grep 'http' | grep -o 'product=".*"' | cut -d \" -f2 | grep -o '^\S*'  > srch.txt
	cat vulnchk.xml | grep 'http' | grep -oE 'version="[0-9]?.[0-9]?.' | grep -Eo '[0-9]?.[0.9].' >> srch.txt
	vv=$(cat srch.txt)
	if [ ! -z srch.txt ]; then
		echo 'Searching exploitdb for' $vv
		searchsploit $vv
		echo ' '
		echo 'Analyzing http vulnerabilities'
        nmap $ip --script=http-vuln\* -v
        echo ' '
		
	else
		echo ' '
	fi
}
web_
