#!/bin/bash

root() {
  if (( $EUID == 0 )); then
    root=$true
    shadow
  else
    root=$false
  fi
}

network_info() {
  hostname -f
  ifconfig
  netstat -r
}

password_info() {
  cat /etc/passwd | awk -F ":" '{print $1, $2}'
  cat /etc/crontab
  cat /etc/group
  if (( $EUID == 0 )); then
    cat /etc/shadow | awk -F ":" '{print $1, $2}'
  fi
}

discovery() {
  cd /
  find . -type f -iname '.*history*' 2>/dev/null
  find . -type f -iname '.*ssh*' 2>/dev/null
  find . -type f -iname '.*authorized' 2>/dev/null
  find . -type f -iname '.*gpgps' 2>/dev/null
  find . -type f -iname '.*mysql*' 2>/dev/null
  find . -type f -iname '.*db' 2>/dev/null 
  find . -type f -iname '.*rsa*' 2>/dev/null
  find . -type f -iname '*master' 2>/dev/null
  find . -type f -iname "*password*" 2>/dev/null
  find . -type f -iname "*git*" 2>/dev/null
  ls -lh /media
  ls -lh /home
  ls -lh /home/$USER
 }

shadow() {
  cat /etc/shadow | awk -F ":" '{print $1, $2}'
  
}

root
network_info
password_info
discovery

